<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mappers.erp">
	<resultMap id="SmBimResult"	type="CommitOperationInstructionVO">
		<result property="parentItemCode" column="parentItemCode" />
		<result property="itemName" column="Item_Name" />
		<result property="standard" column="Standard" />
		<result property="inventoryUnit" column="Inventory_Unit" />
		<result property="dailyProduction" column="Dailyproduction" />
		<result property="startDate" column="start_Date" />
		<result property="endDate" column="end_Date" />
	</resultMap>
	<resultMap id="OpePerRegResult" type="OperationRegistVO">
		<result property="workOrderNumber" column="workOrderNumber" />
		<result property="instructionDate" column="InstructionDate" />
		<result property="dueDate" column="dueDate" />
		<result property="itemCode" column="Item_Code" />
		<result property="itemName" column="Item_Name" />
		<result property="standard" column="Standard" />
		<result property="inventoryUnit" column="Inventory_Unit" />
		<result property="indicated" column="IndicatedQuantity" />
		<result property="status" column="status" />
		<result property="inspection" column="Inspection" />
		<result property="note" column="note" />
	</resultMap>
	
	<select id="selectAllProductionPlanInfo" resultMap="SmBimResult">
		<![CDATA[select Item_Code, Item_Name, Standard, Inventory_Unit, DailyProduction from SM_BIM_Ite_Reg]]>
	</select>
	
	<select id="selectAllOperationRegistInfoCondition" parameterType="CommitOperationInstructionVO" resultMap="OpePerRegResult">
		<![CDATA[select * from CPM_PM_Ope_Per_Reg ]]>
		<where>
			<if test="startDate != '' and startDate != null">
				instructionDate between #{startDate} and #{endDate}
			</if>
			<if test="endDate != '' and endDate != null">
				and dueDate between #{startDate} and #{endDate}
			</if>
		</where>
	</select>
	
	<!-- 작업지시 CURD -->
	<select id="selectAllOperationRegistInfo" parameterType="CommitOperationInstructionVO" resultMap="OpePerRegResult">
		<![CDATA[select * from CPM_PM_Ope_Per_Reg ]]>
	</select>
	<insert id="insertOperationInstruction" parameterType="OperationRegistVO">
		<![CDATA[
		 insert into CPM_PM_OPE_PER_REG
		 values(#{workOrderNumber}, '출고대기', 'L101', #{instructionDate}, #{dueDate}, #{itemCode}, #{itemName}, #{standard}, #{inventoryUnit}, #{indicated}, null, null, '계획', '비검사', #{note}, 'JOIN00000009')
		]]>  
	</insert>	
	<!-- 생산 팝업 파트 -->	
	<resultMap id="FactoryViewResult" type="FactoryViewVO">
		<result property="workplaceCode" column="workplace_Code" />
		<result property="workplaceName" column="workplace_Name" />
	</resultMap>
	<select id="selectFactoryList" resultMap="FactoryViewResult">
		<![CDATA[select * from SM_CRI_Wor_Reg]]>
	</select>
	<resultMap id="DepartmentViewResult" type="DepartmentViewVO">
		<result property="departmentCode" column="department_Code" />
		<result property="departmentName" column="department_Name" />
	</resultMap>
	<select id="selectDepartmentList" resultMap="DepartmentViewResult">
		<![CDATA[select* from SM_CRI_Dep_Reg]]>
	</select>
	<resultMap id="selectProductionPlanViewResult" type="ProductionPalnViewVO">
		<result property="no" column="no" />
		<result property="itemCode" column="item_code" />
		<result property="itemName" column="item_Name" />
		<result property="standard" column="standard" />
		<result property="inventoryUnit" column="inventory_unit" />
		<result property="dailyProduction" column="dailyProduction" />
		<result property="sequence" column="sequence" />
		<result property="schedule" column="scheduleddateofoperation" />
		<result property="quantity" column="quantity" />
		<result property="note" column="note" />
	</resultMap>
	<select id="selectProductionPlanList" parameterType="CommitOperationInstructionVO" resultMap="selectProductionPlanViewResult">
		<![CDATA[select * from CPM_PM_Pro_Pla_Reg where scheduleddateofoperation between #{startDate} and #{endDate}]]>
	</select>
	
	<delete id="deleteOperationInstruction">
		delete from CPM_PM_OPE_PER_REG where workOrderNumber = #{workOrderNumber}
	</delete>
	<!-- BOM 파트 -->
	<resultMap id="bomView" type="bomVO">
		<result property="no" column="no" />
		<result property="parent" column = "parent_item_code"/>
		<result property="itemNumber" column="item_code" />
		<result property="itemName" column="item_name" />
		<result property="standard" column="standard" />
		<result property="unit" column="inventory_unit" />
		<result property="precisionQuantity" column="precisionQuantity" />
		<result property="loss" column="loss" />
		<result property="actualCost" column="actualCost" />
		<result property="outSourcingUnitPrice" column="outSourcingUnitPrice" />
		<result property="startDate" column="startDate" />
		<result property="endDate" column="endDate" />
		<result property="division" column="division" />

	</resultMap>
	<resultMap id="popView" type="bomVO">
		<result property="itemNumber" column="item_code" />
		<result property="itemName" column="item_name" />
		<result property="standard" column="standard" />
	</resultMap>
	
	<select id="selectAllMemberList" resultMap="bomView">
		<![CDATA[select * from CPM_BIM_BOM_REG]]>
	</select>
	<select id="selectNo" resultType="int">
		<![CDATA[select MAX(no) from CPM_BIM_BOM_REG]]>
	</select>
	<select id="searchitem" resultMap="bomView"
		parameterType="String">
		<![CDATA[select * from CPM_BIM_BOM_REG where parent_item_code = #{parent}]]>
	</select>
	<select id="selectitem" resultMap="bomView"
		parameterType="String">
		<![CDATA[select item_code,item_name,standard,inventory_unit,division from SM_BIM_Ite_Reg where item_code=#{itemNumber}]]>
	</select>
	<select id="selectPopList1" resultMap="popView">
		<![CDATA[select * from SM_BIM_Ite_Reg where not division='부품']]>
	</select>
	<select id="selectPopList2" resultMap="popView">
		<![CDATA[select * from SM_BIM_Ite_Reg where not division = '완제품']]>
	</select>
	<select id="nullitem" resultMap="bomView"
		parameterType="String">
		<![CDATA[select * from CPM_BIM_BOM_REG]]>
	</select>
	<insert id="insertBOM" parameterType="bomVO">
		<![CDATA[
		 insert into CPM_BIM_BOM_REG
		 values(#{no},#{parent}, #{itemNumber}, #{itemName}, #{standard}, #{unit}, #{precisionQuantity}, #{loss}, #{actualCost}, #{outSourcingUnitPrice}, #{startDate}, #{endDate}, #{division})
		]]>  
	</insert>

	<delete id="deleteBOM">
		delete from CPM_BIM_BOM_REG where NO = #{no}
	</delete>
 
	<update id="updateBOM" parameterType="bomVO">
		<![CDATA[
		update CPM_BIM_BOM_REG
		set Item_Name=#{itemName}, Standard=#{standard}, Inventory_Unit=#{unit},precisionQuantity=#{precisionQuantity}, loss=#{loss},actualCost=#{actualCost}, outSourcingUnitPrice=#{outSourcingUnitPrice}, startDate=#{startDate}, endDate=#{endDate}, division=#{division}
		where  no=#{no}
		]]>  
	</update>
	
	
	
	

	<!-- mainPaln 파트 -->
	<resultMap id="mainplanResult" type="mainplanVO">
		<result property="plandate" column="plandate" />
		<result property="item_Code" column="item_Code" />
		<result property="item_Name" column="item_Name" />
		<result property="standard" column="standard" />
		<result property="unit" column="unit" />
		<result property="sequence" column="sequence" />
		<result property="expected_date" column="expected_date" />
		<result property="due_date" column="due_date" />
		<result property="plan_quantity" column="plan_quantity" />
		<result property="customer_name" column="customer_name" />
		<result property="note" column="note" />
	</resultMap>
	<resultMap type="mpsosVO" id="MpsOSResult">
		<result column="ordersno" property="ordersno" />
		<result column="sequence" property="sequence" />
		<result column="orderdate" property="orderdate" />
		<result column="okeydate" property="okeydate" />
		<result column="customer_name" property="customer_name" />
		<result column="item_Code" property="item_Code" />
		<result column="item_Name" property="item_Name" />
		<result column="standard" property="standard" />
		<result column="unit" property="unit" />
		<result column="order_quantity" property="order_quantity" />
		<result column="apply_quantity" property="apply_quantity" />
		<result column="order_Balance" property="order_Balance" />
		<result column="expected_Date" property="expected_Date" />
		<result column="note" property="note" />
	</resultMap>

	<select id="selectAllMainPlanList" resultMap="mainplanResult">
		<![CDATA[SELECT * from pmm_pm_mps]]>
	</select>
	<select id="selectAllMpsosList" resultMap="MpsOSResult">
		<![CDATA[SELECT * from pmm_pm_mps_os]]>
	</select>

	<!-- billing파트 -->
	<resultMap id="billingResult" type="billingVO">
		<result property="claim_no" column="claim_no" />
		<result property="claim_date" column="claim_date" />
		<result property="claim_division" column="claim_division" />
		<result property="note" column="note" />
	</resultMap>
	<resultMap id="ListResult" type="listVO">
		<result column="sequence" property="sequence" />
		<result column="item_Code" property="item_Code" />
		<result column="item_Name" property="item_Name" />
		<result column="standard" property="standard" />
		<result column="requestdate" property="requestdate" />
		<result column="inventory_unit" property="inventory_unit" />
		<result column="inventory_qy" property="inventory_qy" />
		<result column="claim_unit" property="claim_unit" />
		<result column="claim_quantity" property="claim_quantity" />
		<result column="customer_name" property="customer_name" />		
	</resultMap>
	<resultMap id="mrpamountResult" type="requiredamountVO">
		<result property="need_date" column="need_date" />
		<result property="expected_order" column="expected_order" />
		<result property="item_Code" column="item_Code" />
		<result property="item_Name" column="item_Name" />
		<result property="standard" column="standard" />
		<result property="unit" column="unit" />
		<result property="expected_quantity" column="expected_quantity" />
	</resultMap>

	<select id="selectAllcmList" resultMap="billingResult">
		<![CDATA[SELECT * from PMM_PM_CM]]>
	</select>
	
	<select id="selectAllBottomList" resultMap="ListResult">
		<![CDATA[select * from pmm_pm_cm_list]]>
	</select>
	
	<select id="selectAllMrpaMount" resultMap="mrpamountResult">
		<![CDATA[select need_date,expected_order,item_Code,item_Name,standard,unit,expected_quantity
			from pmm_pm_mrp]]>
	</select>
	
	

	<!-- mrp파트 -->
	<resultMap id="mrpResult" type="requiredamountVO">
		<result property="item_Code" column="item_Code" />
		<result property="item_Name" column="item_Name" />
		<result property="standard" column="standard" />
		<result property="need_date" column="need_date" />
		<result property="sequence" column="sequence" />
		<result property="expected_order" column="expected_order" />
		<result property="expected_quantity" column="expected_quantity" />
		<result property="unit" column="unit" />
	</resultMap>

	<select id="selectAllMrpList" resultMap="mrpResult">
		<![CDATA[SELECT * from pmm_pm_mrp]]>
	</select>
	
	<!-- 품목단가등록파트 재원-->
	<!-- <resultMap id="itemView" type="itemVO">
		<result property="Item_Code" column="Item_Code" /> 품번
		<result property="Item_Name" column="Item_Name" /> 품명
		<result property="Standard" column="Standard" /> 규격
		<result property="Inventory_Unit" column="Inventory_Unit" /> 단위
		<result property="Kind" column="Kind" /> 종류(구매단가,판매단가)
		<result property="Purchase_Price" column="Purchase_Price" /> 구매단가
		<result property="Sales_Price" column="Sales_Price" /> 판매단가, 구매단가입력시 Null
	</resultMap>
	<resultMap id="popView" type="itemVO">
		<result property="Item_Code" column="Item_Code" />
		<result property="Item_Name" column="Item_Name" />
		<result property="standard" column="standard" />
	</resultMap>

	<select id="selectAllMemberList" resultMap="itemView">
		<![CDATA[select * from CPM_BIM_BOM_REG]]>
	</select>
	<select id="searchitem" resultMap="itemView"
		parameterType="String">
		<![CDATA[select * from CPM_BIM_BOM_REG where item_code = #{itemNumber}]]>
	</select>
	<select id="selectitem" resultMap="itemView"
		parameterType="String">
		<![CDATA[select item_code,item_name,standard,inventory_unit from CPM_BIM_BOM_REG where item_code=#{itemNumber}]]>
	</select>
	<select id="selectPopList" resultMap="popView">
		<![CDATA[select * from CPM_BIM_BOM_REG]]>
	</select>
	<insert id="insertItem" parameterType="itemVO">
		<![CDATA[
		 insert into CPM_BIM_BOM_REG
		 values(#{no}, #{itemNumber}, #{itemName}, #{standard}, #{unit}, #{precisionQuantity}, #{loss}, #{actualQuantity}, #{actualCost}, #{outSourcingUnitPrice}, #{startDate}, #{endDate}, #{note})
		]]>  
	</insert>
	<update id="updateItem" parameterType="itemVO">
		<![CDATA[
		update CPM_BIM_BOM_REG
		set item_name=#{itemName}, standard=#{standard}, inventory_unit=#{unit}
		where  item_code=#{itemNumber}
		]]>  
	</update> -->
	
	<!-- 외주발주등록 파트 -->
<resultMap id="outsourcingView" type="RegOutsourcingVO">
		<result property="workOrderNumber" column="workOrderNumber" />
		<result property="instructionDate" column="instructionDate" />
		<result property="dueDate" column="dueDate" />
		<result property="item_Code" column="Item_Code" />
		<result property="item_Name" column="Item_Name" />
		<result property="standard" column="Standard" />
		<result property="inventory_Unit" column="Inventory_Unit" />
		<result property="indicatedQuantity" column="indicatedQuantity" />
		<result property="unitPrice" column="unitPrice" />				
		<result property="status" column="status" />
		<result property="inspection" column="inspection" />
		<result property="note" column="note" />
	</resultMap>
	
	
	<select id="selectAllOutsourcingList" resultMap="outsourcingView">
		<![CDATA[select workOrderNumber,instructionDate,dueDate,Item_Code,Item_Name,Standard,Inventory_Unit,indicatedQuantity,unitPrice,indicatedQuantity*unitPrice,status,inspection,note  from CPM_OM_Out_Per_Reg]]>
	</select>
	
	
	<delete id="deleteOutsourcing" parameterType="int">
		<![CDATA[delete from t_member where id=#{id}]]>
	</delete>

	<insert id="insertOutsourcing" parameterType="regOutsourcingVO">
		<![CDATA[
		 insert into CPM_BIM_BOM_REG
		 values(#{no},#{parent}, #{itemNumber}, #{itemName}, #{standard}, #{unit}, #{precisionQuantity}, #{loss}, #{actualCost}, #{outSourcingUnitPrice}, #{startDate}, #{endDate}, #{note})
		]]>  
	</insert>

</mapper>